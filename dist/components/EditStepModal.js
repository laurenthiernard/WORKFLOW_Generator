import e,{useState as r,useContext as h}from"../../web_modules/react.js";import D from"../WorkflowContext.js";import t from"./EditStepModal.module.css.proxy.js";export default function g({viewportPosition:o,onUpdate:R,onClose:i,stepJson:n,stepJson:{Title:N,StepDurationDays:x,StepNumber:d,IsDraft:w}}){const s=h(D),[E,p]=r(n.Title),[m,f]=r(n.StepDurationDays),[u,U]=r(n.IsDraft),[P,k]=r({rejected:"back"}),c=s?.currentWorkflow?.TemplateLocked;function b(){return d>=2?!s?.currentWorkflow.WorkFlowTemplateSteps[d-2].IsDraft:!1}function _(a){let l=a.target.value;switch(a.target.id){case"duration":f(Number(l));break;case"title":p(l);break;case"draft":l=a.target.checked,U(l);break;case"rules":const C=a.target.selectedIndex;k({rejected:C===0?"back":"continue"});break;default:break}}function v(a){const l={...n,Title:E,StepDurationDays:m,IsDraft:u};R(l),i()}function S(a){i()}return e.createElement(e.Fragment,null,e.createElement("div",{className:t.backdrop,onClick:S}),e.createElement("div",{className:t.EditStepModal_Container,style:{left:o.x,top:o.y}},e.createElement("div",{className:t.EditStepModal_Header},e.createElement("h1",null,"Edit Step")),e.createElement("div",{className:t.EditStepModal_Content},e.createElement("div",{className:t.EditStepModal_Content_Row},e.createElement("h3",null,"Title"),e.createElement("div",null,e.createElement("input",{type:"text",className:t.title,name:"title",id:"title",value:E,onChange:_,disabled:c}))),e.createElement("div",{className:t.EditStepModal_Content_Row_Inline},e.createElement("div",null,e.createElement("h3",null,"Duration"),e.createElement("div",null,e.createElement("input",{type:"number",className:t.duration,name:"duration",id:"duration",min:"1",max:"99",value:m,onChange:_,disabled:c}))),e.createElement("div",{className:t.draftToggle_Container},e.createElement("div",{className:t.draftToggle},e.createElement("h3",null,"Set as Draft"),e.createElement("input",{type:"checkbox",name:"draft",id:"draft",checked:u,disabled:b(),onChange:_})))),e.createElement("div",{className:t.EditStepModal_Content_Row},e.createElement("h2",null,"Step Completion Rules"),e.createElement("h3",null,"If Rejected:"),e.createElement("select",{name:"rules",id:"rules",className:t.rules,onChange:_,value:P.rejected,disabled:c},e.createElement("option",{value:"back"},"Back to workflow initiator"),e.createElement("option",{value:"continue"},"Continue to next step")))),e.createElement("div",{className:t.EditStepModal_Footer},e.createElement("button",{className:`btn ${t.EditStepModal_btnOK}`,onClick:v},"OK"))))}
