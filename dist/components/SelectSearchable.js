import l,{useState as b,useEffect as S,useRef as U}from"../../web_modules/react.js";import s from"./SelectSearchable.module.css.proxy.js";import{FontAwesomeIcon as u}from"../../web_modules/@fortawesome/react-fontawesome.js";import{faAngleUp as g,faAngleDown as C,faTimes as h}from"../../web_modules/@fortawesome/free-solid-svg-icons.js";function N(e){const[_,r]=b(e),n=U(null),o=d=>{n.current&&!n.current.contains(d.target)&&r(!1)};return S(()=>(document.addEventListener("click",o,!0),()=>{document.removeEventListener("click",o,!0)}),[]),{ref:n,isVisible:_,setIsVisible:r}}export default function y(e){const[_,r]=b(""),n=U(null),o=e.items,d=e.allowMultiple,f=e.width,w=_.split(" ").filter(t=>t.length>0),R=()=>o.filter(t=>w.every(c=>String(t.label).toLowerCase().includes(c.toLowerCase()))),{ref:P,isVisible:m,setIsVisible:E}=N(!1,n);function I(t,c){if(t.stopPropagation(),t.currentTarget.className.includes("delete")){if(e.deleteMode==="keep"){const a=e.selectedItems.findIndex(v=>v.UserGUID===c.UserGUID),i=[...e.selectedItems];i[a].IsDeleted=!0,e.onSelectItem([...i])}else e.onSelectItem(e.selectedItems.filter(a=>a.GUID!==c.GUID));return}if(d){const a=e.selectedItems.findIndex(i=>i.label===c.label);a>-1?e.onSelectItem(e.selectedItems.filter(i=>i!==c)):e.onSelectItem([...e.selectedItems,c])}else e.onSelectItem([c]),E(!1)}S(()=>{n.current&&n.current.focus()},[m]);const k=f==="s"?s.ListSmall:f==="m"?s.ListMedium:s.ListLarge;return l.createElement("div",{className:s.selectSearchable_Container},l.createElement("div",{className:s.selectSearchable_Header,onClick:t=>E(!m)},l.createElement("div",{className:s.selectSearchable_SelectedContainer},e.selectedItems.map((t,c)=>l.createElement("div",{key:c,className:s.selectSearchable_SelectedItem},t.label,l.createElement("span",{className:s.selectedItem_delete,onClick:a=>I(a,t)},l.createElement(u,{icon:h})))).filter(t=>!t.Isdeleted)),l.createElement("div",{className:s.selectSearchable_Trigger},l.createElement(u,{icon:m?C:g}))),m&&l.createElement("div",{style:{position:"absolute"},className:`${s.selectSearchable_List} ${k}`,ref:P},l.createElement("div",{className:s.selectSearchable_SearchContainer},l.createElement("input",{type:"text",value:_,onChange:t=>r(t.target.value),ref:n}),l.createElement(u,{icon:h,onClick:t=>r("")})),l.createElement("div",{className:s.selectSearchable_ItemsContainer},R().map((t,c)=>l.createElement("span",{key:c,className:`${s.selectItem} ${e.selectedItems.findIndex(a=>t.label===a.label)>-1?s.selectSearchable_SelectedItem_Selected:""}`,onClick:a=>I(a,t)},t.label)))))}
